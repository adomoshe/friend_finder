<!DOCTYPE html>
<html>

<head>
    <meta charset='utf-8'>
    <meta name='viewport' content='width=device-width, initial-scale=1'>
    <title>Friend Finder</title>
    <link rel='stylesheet' href='https://stackpath.bootstrapcdn.com/bootstrap/4.1.3/css/bootstrap.min.css' integrity='sha384-MCw98/SFnGE8fJT3GXwEOngsV7Zt27NXFoaoApmYm81iuXoPkFOJwJ8ERdknLPMO'
        crossorigin='anonymous'>
    <script src="https://code.jquery.com/jquery-3.3.1.min.js" integrity="sha256-FgpCb/KJQlLNfOu91ta32o/NMZxltwRo8QtmkMRdAu8="
        crossorigin="anonymous"></script>
    <script src="https://cdnjs.cloudflare.com/ajax/libs/popper.js/1.14.3/umd/popper.min.js" integrity="sha384-ZMP7rVo3mIykV+2+9J3UJ46jBk0WLaUAdn689aCwoqbBJiSnjAK/l8WvCWPIPm49"
        crossorigin="anonymous"></script>
    <script src="https://stackpath.bootstrapcdn.com/bootstrap/4.1.3/js/bootstrap.min.js" integrity="sha384-ChfqqxuZUCnJSK3+MXmPNIyE6ZbWh2IMqE241rYiqJxyMiZ6OW/JmZQ5stwEULTy"
        crossorigin="anonymous"></script>
</head>
<style>
    body {
        background-color: rgb(204, 219, 236);
        background-attachment: fixed;
    }

    .card1 {
        margin-top: 4%;
        margin-bottom: 4%;
    }

    .match-image {
        float: left;
        height: 600px;
        width: 520px;
    }
    
</style>

<body>
    <nav class='navbar navbar-expand navbar-dark bg-primary'>
        <div class='text-light'>Friend Finder</div>
        <button class='navbar-toggler' type='button' data-toggle='collapse' data-target='#navbarText' aria-controls='navbarText'
            aria-expanded='false' aria-label='Toggle navigation'>
            <span class='navbar-toggler-icon'></span>
        </button>
        <div class='collapse navbar-collapse justify-content-end' id='navbarText'>
            <ul class='navbar-nav'>
                <li class='nav-item active'>
                    <a class='btn bg-primary nav-link' href='api/friends'>API Friends List</a>
                </li>
                <li class='nav-item active'>
                    <a class='btn bg-primary nav-link' href='https://github.com/adomoshe' target='_blank'>Github Repo</a>
                </li>
            </ul>
        </div>
    </nav>

    <nav class='container-fluid'>
        <nav class='row'>
            <nav class='col-sm-6 mx-auto'>
                <div class='card card1'>
                    <div class='card-body'>
                        <h3 class='card-title text-primary'>Survey Questions</h3>
                        <hr>
                        <h3>About You</h3>
                        <br>
                        <h4>Name</h4>
                        <form>
                            <input type='text' placeholder='Bob Smith' id='name' class='form-control'>
                            <br>
                            <h4>Web Link to Photo</h4>
                            <input type='text' placeholder='www.img/url.com' id='photo' class='form-control'>
                            <hr>
                            <div class='form-group'>
                                <h3 class='text-primary'>Question 1</h3>
                                <h4>You like long walks on the beach.</h4>
                                <select class='form-group' id='question1'>
                                    <option value=''>Choose Value</option>
                                    <option value='1'>1 (Strongly Disagree)</option>
                                    <option value='2'>2</option>
                                    <option value='3'>3</option>
                                    <option value='4'>4</option>
                                    <option value='5'>5 (Strongly Agree)</option>
                                </select>
                            </div>

                            <div class='form-group'>
                                <h3 class='text-primary'>Question 2</h3>
                                <h4>You want to live in the city.</h4>
                                <select class='form-group' id='question2'>
                                    <option value=''>Choose Value</option>
                                    <option value='1'>1 (Strongly Disagree)</option>
                                    <option value='2'>2</option>
                                    <option value='3'>3</option>
                                    <option value='4'>4</option>
                                    <option value='5'>5 (Strongly Agree)</option>
                                </select>
                            </div>

                            <div class='form-group'>
                                <h3 class='text-primary'>Question 3</h3>
                                <h4>You like to laugh.</h4>
                                <select class='form-group' id='question3'>
                                    <option value=''>Choose Value</option>
                                    <option value='1'>1 (Strongly Disagree)</option>
                                    <option value='2'>2</option>
                                    <option value='3'>3</option>
                                    <option value='4'>4</option>
                                    <option value='5'>5 (Strongly Agree)</option>
                                </select>
                            </div>

                            <div class='form-group'>
                                <h3 class='text-primary'>Question 4</h3>
                                <h4>You are spontaneous.</h4>
                                <select class='form-group' id='question4'>
                                    <option value=''>Choose Value</option>
                                    <option value='1'>1 (Strongly Disagree)</option>
                                    <option value='2'>2</option>
                                    <option value='3'>3</option>
                                    <option value='4'>4</option>
                                    <option value='5'>5 (Strongly Agree)</option>
                                </select>
                            </div>

                            <div class='form-group'>
                                <h3 class='text-primary'>Question 5</h3>
                                <h4>You enjoy classical music</h4>
                                <select class='form-group' id='question5'>
                                    <option value=''>Choose Value</option>
                                    <option value='1'>1 (Strongly Disagree)</option>
                                    <option value='2'>2</option>
                                    <option value='3'>3</option>
                                    <option value='4'>4</option>
                                    <option value='5'>5 (Strongly Agree)</option>
                                </select>
                            </div>

                            <div class='form-group'>
                                <h3 class='text-primary'>Question 6</h3>
                                <h4>Cooking is your passion.</h4>
                                <select class='form-group' id='question6'>
                                    <option value=''>Choose Value</option>
                                    <option value='1'>1 (Strongly Disagree)</option>
                                    <option value='2'>2</option>
                                    <option value='3'>3</option>
                                    <option value='4'>4</option>
                                    <option value='5'>5 (Strongly Agree)</option>
                                </select>
                            </div>

                            <div class='form-group'>
                                <h3 class='text-primary'>Question 7</h3>
                                <h4>You enjoy travel.</h4>
                                <select class='form-group' id='question7'>
                                    <option value=''>Choose Value</option>
                                    <option value='1'>1 (Strongly Disagree)</option>
                                    <option value='2'>2</option>
                                    <option value='3'>3</option>
                                    <option value='4'>4</option>
                                    <option value='5'>5 (Strongly Agree)</option>
                                </select>
                            </div>

                            <div class='form-group'>
                                <h3 class='text-primary'>Question 8</h3>
                                <h4>You are extroverted.</h4>
                                <select class='form-group' id='question8'>
                                    <option value=''>Choose Value</option>
                                    <option value='1'>1 (Strongly Disagree)</option>
                                    <option value='2'>2</option>
                                    <option value='3'>3</option>
                                    <option value='4'>4</option>
                                    <option value='5'>5 (Strongly Agree)</option>
                                </select>
                            </div>

                            <div class='form-group'>
                                <h3 class='text-primary'>Question 9</h3>
                                <h4>You like to read.</h4>
                                <select class='form-group' id='question9'>
                                    <option value=''>Choose Value</option>
                                    <option value='1'>1 (Strongly Disagree)</option>
                                    <option value='2'>2</option>
                                    <option value='3'>3</option>
                                    <option value='4'>4</option>
                                    <option value='5'>5 (Strongly Agree)</option>
                                </select>
                            </div>

                            <div class='form-group'>
                                <h3 class='text-primary'>Question 10</h3>
                                <h4>Weekends are for fun.</h4>
                                <select class='form-group' id='question10'>
                                    <option value=''>Choose Value</option>
                                    <option value='1'>1 (Strongly Disagree)</option>
                                    <option value='2'>2</option>
                                    <option value='3'>3</option>
                                    <option value='4'>4</option>
                                    <option value='5'>5 (Strongly Agree)</option>
                                </select>
                            </div>
                    </div>
                    <br>
                    <button type='submit' class='btn btn-primary btn-lg' id='submitForm'>Submit</button>
                    </form>
                </div>

                <div class="modal fade bd-example-modal-lg" id="modal" tabindex="-1" role="dialog" aria-labelledby="exampleModalLabel"
                    aria-hidden="true">
                    <div class="modal-dialog modal-lg" role="document">
                        <div class="modal-content">
                            <div class="modal-header">
                                <h5 class="modal-title" id="exampleModalLabel">Your New Friend!</h5>
                                <button type="button" class="close" data-dismiss="modal" aria-label="Close">
                                    <span aria-hidden="true">&times;</span>
                                </button>
                            </div>
                            <div class="modal-body" id='modal-body1'>
                            </div>
                            <div class="modal-footer">
                                <button type="button" class="btn btn-secondary" data-dismiss="modal">Close</button>
                            </div>
                        </div>
                    </div>
                </div>

            </nav>
        </nav>
    </nav>

    <footer>
    </footer>
</body>

</html>

<script>
    let scores = []

    function scoresKey(value) {
        for (i = 1; i < 11; i++) {
            if (value === 'take') {
                scores.push($(`#question${i}`).val().trim());
            };
            if (value === 'clear') {
                $(`#question${i}`).val('');
            };
            if (value === 'validate') {
                if ($(`#question${i}`).val() === '') {
                    return i;
                };
            };
        };
    };

    function validate() {
        try {
            if (!$('#name').val().trim()) { throw 'enter a name' };
            if (!$('#photo').val().trim()) { throw 'input a valid photo url' };
            if (scoresKey('validate')) { throw `answer question ${i}`};
        } catch (err) {
            alert(`Please ${err}`);
            return false;
        };
        return true;
    };

    $('#submitForm').on('click', function (event) {
        event.preventDefault();
        if (!(validate())) { return; };
        scoresKey('take');
        const newFriend = {
            name: $('#name').val().trim(),
            photo: $('#photo').val().trim(),
            scores: scores
        };

        $.post('/api/friends', newFriend, function (data) {
            $('#name').val('');
            $('#photo').val('');
            scoresKey('clear');
            scores = [];
        }).then(
            $.get('/api/friends/match', function (data) {
                let matchName = $('<h3>');
                matchName.text(data[0].name);
                $('#modal-body1').append(matchName);
                let matchPic = $('<img>');
                matchPic.attr('src', data[0].photo);
                matchPic.attr('alt', 'Match-image');
                matchPic.addClass('match-image');
                $('#modal-body1').append(matchPic);
                $('#modal').modal();
            })
        );
    });

</script>